# ğŸ› VSCode è°ƒè¯•æŒ‡å—

## å¿«é€Ÿå¼€å§‹

æˆ‘å·²ç»ä¸ºä½ é…ç½®å¥½äº† VSCode è°ƒè¯•ï¼ç°åœ¨å¯ä»¥è½»æ¾è°ƒè¯•çˆ¬è™«ä»£ç äº†ã€‚

## ğŸ“‹ å¯ç”¨çš„è°ƒè¯•é…ç½®

### 1. ğŸ› Debug test:scraper

è°ƒè¯•æµ‹è¯•è„šæœ¬ï¼ˆæ— å¤´æ¨¡å¼ï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼šè°ƒè¯•çˆ¬è™«é€»è¾‘ï¼Œä¸éœ€è¦çœ‹æµè§ˆå™¨

**æ­¥éª¤**ï¼š

1. åœ¨ `test-scraper.ts` æˆ– `scraper.ts` ä¸­è®¾ç½®æ–­ç‚¹
2. æŒ‰ `F5` æˆ–ç‚¹å‡» `Run and Debug` é¢æ¿
3. é€‰æ‹© "ğŸ› Debug test:scraper"
4. ä»£ç ä¼šåœ¨æ–­ç‚¹å¤„æš‚åœ

### 2. ğŸ” Debug test:scraper (Visible Browser)

è°ƒè¯•æµ‹è¯•è„šæœ¬ï¼ˆæ˜¾ç¤ºæµè§ˆå™¨ï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼šéœ€è¦çœ‹åˆ°æµè§ˆå™¨å®é™…æ“ä½œ

**æ­¥éª¤**ï¼š

1. è®¾ç½®æ–­ç‚¹
2. é€‰æ‹© "ğŸ” Debug test:scraper (Visible Browser)"
3. æµè§ˆå™¨ä¼šæ‰“å¼€ï¼Œä½ å¯ä»¥åŒæ—¶çœ‹åˆ°é¡µé¢å’Œè°ƒè¯•å˜é‡

### 3. ğŸ§ª Debug test:diagnose

è°ƒè¯•è¯Šæ–­è„šæœ¬

**ä½¿ç”¨åœºæ™¯**ï¼šè°ƒè¯•è¯Šæ–­å·¥å…·æœ¬èº«

### 4. ğŸš€ Debug API Server

è°ƒè¯• API æœåŠ¡å™¨

**ä½¿ç”¨åœºæ™¯**ï¼šè°ƒè¯• API è·¯ç”±å’Œè¯·æ±‚å¤„ç†

**æ­¥éª¤**ï¼š

1. åœ¨ `index.ts` æˆ– `scraper.ts` ä¸­è®¾ç½®æ–­ç‚¹
2. é€‰æ‹© "ğŸš€ Debug API Server"
3. æœåŠ¡å™¨å¯åŠ¨åï¼Œä»æµè§ˆå™¨æˆ– curl å‘é€è¯·æ±‚
4. æ–­ç‚¹ä¼šè§¦å‘

### 5. ğŸ”§ Debug Current TS File

è°ƒè¯•å½“å‰æ‰“å¼€çš„ TypeScript æ–‡ä»¶

**ä½¿ç”¨åœºæ™¯**ï¼šå¿«é€Ÿè°ƒè¯•å•ä¸ªæ–‡ä»¶

**æ­¥éª¤**ï¼š

1. æ‰“å¼€ä»»æ„ `.ts` æ–‡ä»¶
2. è®¾ç½®æ–­ç‚¹
3. é€‰æ‹© "ğŸ”§ Debug Current TS File"

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1ï¼šä½¿ç”¨ F5 é”®ï¼ˆæ¨èï¼‰

1. **æ‰“å¼€è¦è°ƒè¯•çš„æ–‡ä»¶**ï¼ˆå¦‚ `test-scraper.ts`ï¼‰
2. **ç‚¹å‡»è¡Œå·å·¦ä¾§è®¾ç½®æ–­ç‚¹**ï¼ˆä¼šå‡ºç°çº¢ç‚¹ï¼‰
3. **æŒ‰ `F5` é”®**
4. **é€‰æ‹©è°ƒè¯•é…ç½®**ï¼ˆå¦‚ "Debug test:scraper"ï¼‰
5. **ç­‰å¾…æ–­ç‚¹è§¦å‘**

### æ–¹æ³• 2ï¼šä½¿ç”¨ä¾§è¾¹æ 

1. **ç‚¹å‡»ä¾§è¾¹æ çš„ "Run and Debug" å›¾æ ‡**ï¼ˆæˆ–æŒ‰ `Ctrl+Shift+D`ï¼‰
2. **ä»ä¸‹æ‹‰èœå•é€‰æ‹©è°ƒè¯•é…ç½®**
3. **ç‚¹å‡»ç»¿è‰²æ’­æ”¾æŒ‰é’®**
4. **ä»£ç ä¼šåœ¨æ–­ç‚¹å¤„æš‚åœ**

## ğŸ”§ è°ƒè¯•æŠ€å·§

### è®¾ç½®æ–­ç‚¹

```typescript
// åœ¨è¿™è¡Œå·¦ä¾§ç‚¹å‡»ï¼Œä¼šå‡ºç°çº¢ç‚¹
const products = await scraper.searchBestsellers(keyword);
```

### æ¡ä»¶æ–­ç‚¹

å³é”®æ–­ç‚¹ â†’ Edit Breakpoint â†’ æ·»åŠ æ¡ä»¶

```typescript
// åªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æš‚åœ
products.length === 0;
```

### æ—¥å¿—ç‚¹ï¼ˆLogpointï¼‰

å³é”®è¡Œå· â†’ Add Logpoint

```typescript
// ä¸æš‚åœï¼Œåªè¾“å‡ºæ—¥å¿—
Product count: {products.length}
```

### è°ƒè¯•é¢æ¿åŠŸèƒ½

å½“ä»£ç æš‚åœæ—¶ï¼š

- **Variablesï¼ˆå˜é‡ï¼‰**ï¼šæŸ¥çœ‹å½“å‰ä½œç”¨åŸŸçš„æ‰€æœ‰å˜é‡
- **Watchï¼ˆç›‘è§†ï¼‰**ï¼šæ·»åŠ è¡¨è¾¾å¼å®æ—¶ç›‘æ§
- **Call Stackï¼ˆè°ƒç”¨å †æ ˆï¼‰**ï¼šæŸ¥çœ‹å‡½æ•°è°ƒç”¨é“¾
- **Breakpointsï¼ˆæ–­ç‚¹ï¼‰**ï¼šç®¡ç†æ‰€æœ‰æ–­ç‚¹

### æ§åˆ¶æŒ‰é’®

- **Continueï¼ˆF5ï¼‰**ï¼šç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹
- **Step Overï¼ˆF10ï¼‰**ï¼šæ‰§è¡Œå½“å‰è¡Œï¼Œä¸è¿›å…¥å‡½æ•°
- **Step Intoï¼ˆF11ï¼‰**ï¼šè¿›å…¥å‡½æ•°å†…éƒ¨
- **Step Outï¼ˆShift+F11ï¼‰**ï¼šè·³å‡ºå½“å‰å‡½æ•°
- **Restartï¼ˆCtrl+Shift+F5ï¼‰**ï¼šé‡å¯è°ƒè¯•
- **Stopï¼ˆShift+F5ï¼‰**ï¼šåœæ­¢è°ƒè¯•

## ğŸ’¡ å®ç”¨è°ƒè¯•åœºæ™¯

### åœºæ™¯ 1ï¼šè°ƒè¯•æœç´¢åŠŸèƒ½

```typescript
// test-scraper.ts
async function main() {
  const scraper = new TemuScraper({
    headless: false, // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹è¿™é‡Œ
    maxProducts: 3,
    debug: true,
  });

  await scraper.init();

  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹è¿™é‡Œï¼ŒæŸ¥çœ‹scraperå¯¹è±¡
  const products = await scraper.searchBestsellers("phone case");

  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹è¿™é‡Œï¼ŒæŸ¥çœ‹productså†…å®¹
  console.log(`Found ${products.length} products`);
}
```

**Watch è¡¨è¾¾å¼**ï¼š

- `products.length`
- `products[0]?.title`
- `scraper.config`

### åœºæ™¯ 2ï¼šè°ƒè¯•é¡µé¢åŠ è½½

```typescript
// scraper.ts
async searchBestsellers(keyword: string) {
  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹ï¼Œæ£€æŸ¥pageå¯¹è±¡
  await page.goto(searchUrl, {
    waitUntil: "networkidle2",
    timeout: this.config.timeout,
  });

  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹ï¼ŒæŸ¥çœ‹é¡µé¢å†…å®¹
  const pageTitle = await page.title();

  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹ï¼Œæ£€æŸ¥æå–çš„äº§å“æ•°æ®
  const products = await page.evaluate(...);
}
```

**Watch è¡¨è¾¾å¼**ï¼š

- `pageTitle`
- `products.length`
- `this.config.debug`

### åœºæ™¯ 3ï¼šè°ƒè¯• API è¯·æ±‚æ‹¦æˆª

```typescript
// scraper.ts
page.on("request", (request) => {
  const url = request.url();
  // ğŸ‘ˆ æ¡ä»¶æ–­ç‚¹: url.includes('/api/')
  if (url.includes("/api/")) {
    this.apiRequests.push({
      url,
      method: request.method(),
      // ...
    });
  }
});
```

**æ¡ä»¶æ–­ç‚¹**ï¼š

```
url.includes('/api/') && request.method() === 'POST'
```

### åœºæ™¯ 4ï¼šè°ƒè¯• API æœåŠ¡å™¨

```typescript
// index.ts
app.post("/api/search-bestsellers", async (req, res) => {
  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹ï¼ŒæŸ¥çœ‹è¯·æ±‚ä½“
  const { keywords } = req.body;

  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹ï¼ŒæŸ¥çœ‹çˆ¬è™«ç»“æœ
  const products = await scraper.searchBestsellers(searchQuery);

  // ğŸ‘ˆ è®¾ç½®æ–­ç‚¹ï¼ŒæŸ¥çœ‹è½¬æ¢åçš„æ•°æ®
  const bestsellers = products.map(...);
});
```

**Watch è¡¨è¾¾å¼**ï¼š

- `req.body`
- `products.length`
- `bestsellers[0]`

## ğŸš¨ å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šæ–­ç‚¹ä¸è§¦å‘

**åŸå› **ï¼šå¯èƒ½æ˜¯ TypeScript ç¼–è¯‘é—®é¢˜

**è§£å†³**ï¼š

1. ç¡®ä¿ä½¿ç”¨ `tsx` è¿è¡Œï¼ˆå·²åœ¨é…ç½®ä¸­ï¼‰
2. æ£€æŸ¥ `skipFiles` é…ç½®
3. å°è¯•é‡å¯ VSCode

### é—®é¢˜ 2ï¼šæµè§ˆå™¨çª—å£åœ¨è°ƒè¯•æ—¶è‡ªåŠ¨å…³é—­

**åŸå› **ï¼šè°ƒè¯•ç»“æŸå Puppeteer è‡ªåŠ¨å…³é—­

**è§£å†³**ï¼š

```typescript
// åœ¨ä»£ç æœ«å°¾æ·»åŠ 
await this.delay(999999); // ä¿æŒæµè§ˆå™¨æ‰“å¼€
```

æˆ–è€…åœ¨è°ƒè¯•æ—¶è®¾ç½®æ–­ç‚¹ï¼Œä¸è¦è®©ä»£ç æ‰§è¡Œå®Œ

### é—®é¢˜ 3ï¼šæ— æ³•çœ‹åˆ°å˜é‡å€¼

**åŸå› **ï¼šå˜é‡å¯èƒ½åœ¨ä¸åŒä½œç”¨åŸŸ

**è§£å†³**ï¼š

1. åœ¨æ­£ç¡®çš„ä½œç”¨åŸŸè®¾ç½®æ–­ç‚¹
2. ä½¿ç”¨ Watch è¡¨è¾¾å¼
3. åœ¨ Debug Console ä¸­è¾“å…¥å˜é‡åæŸ¥çœ‹

### é—®é¢˜ 4ï¼šè°ƒè¯•å¤ªæ…¢

**åŸå› **ï¼šå¤§é‡æ—¥å¿—æˆ–æ•°æ®

**è§£å†³**ï¼š

1. å‡å°‘ `console.log`
2. ä½¿ç”¨æ¡ä»¶æ–­ç‚¹
3. ä½¿ç”¨ Logpoint ä»£æ›¿æ–­ç‚¹

## ğŸ“ è¿›é˜¶æŠ€å·§

### 1. è°ƒè¯•ç‰¹å®šæœç´¢å…³é”®è¯

ä¿®æ”¹ `test-scraper.ts`ï¼š

```typescript
// é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’å…³é”®è¯
const keyword = process.env.KEYWORD || "phone case";
```

åœ¨ `launch.json` ä¸­æ·»åŠ ï¼š

```json
{
  "name": "ğŸ” Debug Custom Keyword",
  "env": {
    "KEYWORD": "laptop"
  }
}
```

### 2. è°ƒè¯•æ—¶ä¿å­˜æ›´å¤šä¿¡æ¯

åœ¨ `scraper.ts` ä¸­æ·»åŠ ï¼š

```typescript
if (this.config.debug) {
  // ğŸ‘ˆ æ–­ç‚¹è¿™é‡Œï¼Œæ£€æŸ¥æ‰€æœ‰å˜é‡
  debugger; // è¿™ä¼šè§¦å‘æ–­ç‚¹
}
```

### 3. ä½¿ç”¨ Debug Console æ‰§è¡Œä»£ç 

å½“æš‚åœæ—¶ï¼Œå¯ä»¥åœ¨ Debug Console ä¸­ï¼š

```javascript
// æŸ¥çœ‹å˜é‡
products;

// æ‰§è¡Œå‡½æ•°
await page.screenshot({ path: "debug.png" });

// ä¿®æ”¹å˜é‡
this.config.maxProducts = 5;
```

## ğŸ“š æ›´å¤šèµ„æº

- [VSCode è°ƒè¯•æ–‡æ¡£](https://code.visualstudio.com/docs/editor/debugging)
- [Node.js è°ƒè¯•æŒ‡å—](https://nodejs.org/en/docs/guides/debugging-getting-started/)
- [Puppeteer è°ƒè¯•æŠ€å·§](https://pptr.dev/guides/debugging)

## âš¡ å¿«æ·é”®é€ŸæŸ¥

| åŠŸèƒ½               | Windows/Linux   | Mac            |
| ------------------ | --------------- | -------------- |
| å¼€å§‹è°ƒè¯•           | `F5`            | `F5`           |
| ç»§ç»­               | `F5`            | `F5`           |
| å•æ­¥è·³è¿‡           | `F10`           | `F10`          |
| å•æ­¥è¿›å…¥           | `F11`           | `F11`          |
| å•æ­¥è·³å‡º           | `Shift+F11`     | `Shift+F11`    |
| é‡å¯è°ƒè¯•           | `Ctrl+Shift+F5` | `Cmd+Shift+F5` |
| åœæ­¢è°ƒè¯•           | `Shift+F5`      | `Shift+F5`     |
| åˆ‡æ¢æ–­ç‚¹           | `F9`            | `F9`           |
| Run and Debug é¢æ¿ | `Ctrl+Shift+D`  | `Cmd+Shift+D`  |

## ğŸ‰ å¼€å§‹è°ƒè¯•ï¼

1. **æ‰“å¼€ `api-server/test-scraper.ts`**
2. **åœ¨ç¬¬ 15 è¡Œè®¾ç½®æ–­ç‚¹**ï¼ˆ`await scraper.init()` è¿™è¡Œï¼‰
3. **æŒ‰ F5**
4. **é€‰æ‹© "ğŸ” Debug test:scraper (Visible Browser)"**
5. **äº«å—è°ƒè¯•ï¼**

ç¥ä½ è°ƒè¯•é¡ºåˆ©ï¼ğŸš€
